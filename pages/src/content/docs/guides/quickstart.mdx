---
title: ğŸš©äº”åˆ†é’Ÿä¸Šæ‰‹
description: å¿«é€Ÿä¸Šæ‰‹ smart-socket é€šä¿¡æ¡†æ¶
sidebar:
    order: 2
---

import wx_book from './img/wx_book.png'

æ¬¢è¿æ¥åˆ° smart-socket çš„ä¸–ç•Œï¼å¦‚æœä½ åˆšåˆšæ¥è§¦è¿™ä¸ªæ¡†æ¶ï¼Œé‚£ä¹ˆä½ æ¥å¯¹åœ°æ–¹äº†ã€‚æœ¬æ–‡å°†å¸¦ä½ ä¸€æ­¥æ­¥æ„å»ºä¸€ä¸ªå®Œæ•´çš„é€šä¿¡æœåŠ¡ï¼Œè®©ä½ åœ¨çŸ­çŸ­å‡ åˆ†é’Ÿå†…å°±èƒ½çœ‹åˆ°æˆæœã€‚

è™½ç„¶äº”åˆ†é’Ÿèƒ½è®©ä½ å¿«é€Ÿå…¥é—¨ï¼Œä½†è¦æˆä¸ºçœŸæ­£çš„é«˜æ‰‹è¿˜éœ€è¦åœ¨å®è·µä¸­ä¸æ–­ç£¨ç»ƒã€‚

## å‡†å¤‡å·¥ä½œ

åœ¨å¼€å§‹ç¼–ç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›å‡†å¤‡å·¥ä½œï¼š

1. å®‰è£…å¥½ Java å¼€å‘ç¯å¢ƒï¼ˆJDK 8+ï¼‰
2. å‡†å¤‡ä¸€ä¸ª IDEï¼ˆæ¨èä½¿ç”¨ IntelliJ IDEAï¼‰
3. ç¡®ä¿ Maven å·²å®‰è£…å¹¶é…ç½®å¥½

:::note
JDK ç‰ˆæœ¬å…¼å®¹æ€§è¯´æ˜ï¼š
smart-socket 1.7.5 ç‰ˆæœ¬å®Œå…¨å…¼å®¹ JDK 8 åŠä»¥ä¸Šæ‰€æœ‰ç‰ˆæœ¬ï¼Œæ¨èä½¿ç”¨æ­¤ç‰ˆæœ¬ä»¥è·å¾—æœ€ä½³æ€§èƒ½å’Œæœ€æ–°åŠŸèƒ½ã€‚
:::

## ç¬¬ä¸€æ­¥ï¼šåˆ›å»º Maven é¡¹ç›®å¹¶å¼•å…¥ä¾èµ–

é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ Maven é¡¹ç›®ã€‚ç„¶ååœ¨ pom.xml æ–‡ä»¶ä¸­æ·»åŠ  smart-socket ä¾èµ–ï¼š

```xml
<dependencies>
    <dependency>
        <groupId>io.github.smartboot.socket</groupId>
        <artifactId>aio-core</artifactId>
        <version>1.7.5</version>
    </dependency>
</dependencies>
```

:::tip
å¦‚æœä¸‹è½½ä¾èµ–è¾ƒæ…¢ï¼Œå¯ä»¥é…ç½®é˜¿é‡Œäº‘é•œåƒä»“åº“åŠ é€Ÿï¼š
```xml
<repositories>
    <repository>
        <id>alimaven</id>
        <name>aliyun maven</name>
        <url>http://maven.aliyun.com/nexus/content/groups/public/</url>
    </repository>
</repositories>
```
:::

## ç¬¬äºŒæ­¥ï¼šå®šä¹‰é€šä¿¡åè®®

é€šä¿¡çš„ç¬¬ä¸€æ­¥å°±æ˜¯å®šä¹‰åè®®ã€‚è¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²åè®®ï¼Œå®ƒèƒ½å¤Ÿå¤„ç†å˜é•¿å­—ç¬¦ä¸²æ¶ˆæ¯ï¼š

```java
import org.smartboot.socket.Protocol;
import org.smartboot.socket.transport.AioSession;

import java.nio.ByteBuffer;

public class StringProtocol implements Protocol<String> {

    @Override
    public String decode(ByteBuffer readBuffer, AioSession session) {
        // æ£€æŸ¥ç¼“å†²åŒºä¸­æ˜¯å¦æœ‰è¶³å¤Ÿçš„æ•°æ®è¯»å–é•¿åº¦å­—æ®µ
        int remaining = readBuffer.remaining();
        if (remaining < Integer.BYTES) {
            return null;
        }
        
        // æ ‡è®°å½“å‰ä½ç½®ï¼Œå¦‚æœæ•°æ®ä¸å®Œæ•´å¯ä»¥å¤ä½
        readBuffer.mark();
        
        // è¯»å–æ¶ˆæ¯é•¿åº¦
        int length = readBuffer.getInt();
        
        // å¦‚æœæ¶ˆæ¯é•¿åº¦è¶…è¿‡äº†å‰©ä½™æ•°æ®ï¼Œåˆ™è¯´æ˜æ˜¯åŠåŒ…ï¼Œéœ€è¦å¤ä½å¹¶ç­‰å¾…æ›´å¤šæ•°æ®
        if (length > readBuffer.remaining()) {
            readBuffer.reset();
            return null;
        }
        
        // è¯»å–å®Œæ•´çš„æ¶ˆæ¯å†…å®¹
        byte[] b = new byte[length];
        readBuffer.get(b);
        
        // è¿”å›è§£ç åçš„å­—ç¬¦ä¸²
        return new String(b);
    }
}
```

è¿™æ®µä»£ç å®ç°äº†åŸºäºé•¿åº¦å­—æ®µçš„åè®®è§£æï¼Œè¿™æ˜¯ä¸€ç§éå¸¸å¸¸è§çš„é€šä¿¡åè®®è®¾è®¡æ–¹å¼ã€‚

## ç¬¬ä¸‰æ­¥ï¼šå®ç°æœåŠ¡ç«¯

ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºæœåŠ¡ç«¯ç¨‹åºã€‚æœåŠ¡ç«¯ä¼šæ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯ï¼Œå¹¶å°†å…¶åŸæ ·è¿”å›ï¼š

```java
import org.smartboot.socket.MessageProcessor;
import org.smartboot.socket.transport.AioQuickServer;
import org.smartboot.socket.transport.WriteBuffer;

import java.io.IOException;

public class StringServer {

    public static void main(String[] args) throws IOException {
        // åˆ›å»ºæ¶ˆæ¯å¤„ç†å™¨
        MessageProcessor<String> processor = (session, msg) -> {
            System.out.println("æ”¶åˆ°å®¢æˆ·ç«¯æ¶ˆæ¯: " + msg);
            
            // è·å–å†™å…¥ç¼“å†²åŒº
            WriteBuffer outputStream = session.writeBuffer();
            try {
                // å°†æ¶ˆæ¯åŸæ ·è¿”å›ç»™å®¢æˆ·ç«¯
                byte[] bytes = msg.getBytes();
                outputStream.writeInt(bytes.length);  // å…ˆå†™å…¥é•¿åº¦
                outputStream.write(bytes);           // å†å†™å…¥å†…å®¹
            } catch (IOException e) {
                e.printStackTrace();
            }
        };

        // åˆ›å»ºå¹¶å¯åŠ¨æœåŠ¡ç«¯
        AioQuickServer server = new AioQuickServer(8888, new StringProtocol(), processor);
        server.start();
        
        System.out.println("æœåŠ¡ç«¯å·²å¯åŠ¨ï¼Œç›‘å¬ç«¯å£: 8888");
    }
}
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† [AioQuickServer](https://gitee.com/smartboot/smart-socket/blob/master/example/src/main/java/org/smartboot/socket/example/benchmark/StringServer.java) æ¥å¿«é€Ÿæ­å»ºæœåŠ¡ç«¯ï¼Œå®ƒå°è£…äº†å¤§éƒ¨åˆ†å¤æ‚çš„å¼‚æ­¥IOæ“ä½œã€‚

## ç¬¬å››æ­¥ï¼šå®ç°å®¢æˆ·ç«¯

æœ€åæˆ‘ä»¬æ¥åˆ›å»ºå®¢æˆ·ç«¯ç¨‹åºï¼Œå®ƒä¼šè¿æ¥åˆ°æœåŠ¡ç«¯å¹¶å‘é€ä¸€æ¡æµ‹è¯•æ¶ˆæ¯ï¼š

```java
import org.smartboot.socket.MessageProcessor;
import org.smartboot.socket.transport.AioQuickClient;
import org.smartboot.socket.transport.AioSession;
import org.smartboot.socket.transport.WriteBuffer;

import java.io.IOException;

public class StringClient {

    public static void main(String[] args) throws IOException {
        // åˆ›å»ºæ¶ˆæ¯å¤„ç†å™¨ï¼Œå¤„ç†æœåŠ¡ç«¯è¿”å›çš„æ¶ˆæ¯
        MessageProcessor<String> processor = (session, msg) -> 
            System.out.println("æ”¶åˆ°æœåŠ¡ç«¯å“åº”: " + msg);
            
        // åˆ›å»ºå¹¶è¿æ¥å®¢æˆ·ç«¯
        AioQuickClient client = new AioQuickClient("localhost", 8888, new StringProtocol(), processor);
        AioSession session = client.start();
        
        // è·å–å†™å…¥ç¼“å†²åŒºå¹¶å‘é€æ¶ˆæ¯
        WriteBuffer writeBuffer = session.writeBuffer();
        byte[] data = "hello smart-socket".getBytes();
        writeBuffer.writeInt(data.length);  // å…ˆå†™å…¥é•¿åº¦
        writeBuffer.write(data);           // å†å†™å…¥å†…å®¹
        writeBuffer.flush();               // åˆ·æ–°ç¼“å†²åŒºï¼Œç¡®ä¿æ¶ˆæ¯å‘é€
        
        System.out.println("æ¶ˆæ¯å·²å‘é€: hello smart-socket");
    }
}
```

è¿™æ®µä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ [AioQuickClient](https://gitee.com/smartboot/smart-socket/blob/master/example/src/main/java/org/smartboot/socket/example/benchmark/StringClient.java) å¿«é€Ÿåˆ›å»ºå®¢æˆ·ç«¯å¹¶ä¸æœåŠ¡ç«¯å»ºç«‹è¿æ¥ã€‚

## è¿è¡Œæµ‹è¯•

ç°åœ¨è®©æˆ‘ä»¬æ¥æµ‹è¯•åˆšæ‰ç¼–å†™çš„ç¨‹åºï¼š

1. é¦–å…ˆè¿è¡Œ StringServer ç±»çš„ main æ–¹æ³•å¯åŠ¨æœåŠ¡ç«¯
2. ç„¶åè¿è¡Œ StringClient ç±»çš„ main æ–¹æ³•å¯åŠ¨å®¢æˆ·ç«¯

å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œä½ åº”è¯¥ä¼šåœ¨æœåŠ¡ç«¯æ§åˆ¶å°çœ‹åˆ°ï¼š
```
æ”¶åˆ°å®¢æˆ·ç«¯æ¶ˆæ¯: hello smart-socket
```

åœ¨å®¢æˆ·ç«¯æ§åˆ¶å°çœ‹åˆ°ï¼š
```
æ”¶åˆ°æœåŠ¡ç«¯å“åº”: hello smart-socket
```

## æ­å–œä½ ï¼

ğŸ‰ æ­å–œä½ å®Œæˆäº† smart-socket çš„ç¬¬ä¸€ä¸ªé€šä¿¡ç¨‹åºï¼è™½ç„¶è¿™åªæ˜¯ä¸€ä¸ªå°ä¾‹å­ï¼Œä½†å®ƒå±•ç¤ºäº† smart-socket çš„æ ¸å¿ƒåŠŸèƒ½ã€‚

åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°æ›´å¤æ‚çš„åœºæ™¯ï¼Œä¾‹å¦‚ï¼š

- ğŸ”§ **å¼‚å¸¸å¤„ç†**ï¼šå¦‚ä½•ä¼˜é›…åœ°å¤„ç†ç½‘ç»œå¼‚å¸¸å’Œä¸šåŠ¡å¼‚å¸¸
- â±ï¸ **è¶…æ—¶æ§åˆ¶**ï¼šå¦‚ä½•è®¾ç½®åˆç†çš„è¿æ¥å’Œè¯»å†™è¶…æ—¶
- ğŸ“¦ **ç²˜åŒ…æ‹†åŒ…**ï¼šå¦‚ä½•å¤„ç†TCPåè®®ä¸­çš„ç²˜åŒ…å’Œæ‹†åŒ…é—®é¢˜
- â¤ï¸ **å¿ƒè·³æ£€æµ‹**ï¼šå¦‚ä½•ç»´æŒé•¿è¿æ¥çš„æœ‰æ•ˆæ€§
- ğŸ” **æ–­çº¿é‡è¿**ï¼šå¦‚ä½•åœ¨ç½‘ç»œä¸­æ–­åè‡ªåŠ¨æ¢å¤è¿æ¥
- ğŸ“¨ **æ¶ˆæ¯é˜Ÿåˆ—**ï¼šå¦‚ä½•é«˜æ•ˆå¤„ç†å¤§é‡å¹¶å‘æ¶ˆæ¯
- ğŸ”„ **å¹¶å‘æ§åˆ¶**ï¼šå¦‚ä½•åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ä¿è¯ç³»ç»Ÿç¨³å®šæ€§
- ğŸ”’ **çº¿ç¨‹å®‰å…¨**ï¼šå¦‚ä½•é¿å…å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„æ•°æ®ç«äº‰
- âš¡ **æ€§èƒ½ä¼˜åŒ–**ï¼šå¦‚ä½•æœ€å¤§åŒ–ç³»ç»Ÿååé‡

è¿™äº›é—®é¢˜ smart-socket éƒ½æä¾›äº†ç›¸åº”çš„è§£å†³æ–¹æ¡ˆï¼Œä½ å¯ä»¥åœ¨åç»­çš„æ–‡æ¡£ä¸­æ·±å…¥äº†è§£ã€‚

:::tip
æƒ³è¦äº†è§£æ›´å¤šé«˜çº§åŠŸèƒ½ï¼Ÿè¯·ç»§ç»­é˜…è¯»æˆ‘ä»¬çš„å…¶ä»–æ–‡æ¡£ï¼Œæˆ–è€…åŠ å…¥æˆ‘ä»¬çš„æŠ€æœ¯äº¤æµç¾¤è·å¾—å®æ—¶å¸®åŠ©ï¼
:::

<center>
    <h1>smart-socketå®æˆ˜æ•™ç¨‹</h1>
    <img src={wx_book.src} width="40%"/>
</center>